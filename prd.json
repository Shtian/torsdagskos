{
  "project": "Torsdagskos",
  "branchName": "ralph/private-meetup-mvp",
  "description": "Private meetup coordination website for monthly recurring events among close friends",
  "userStories": [
    {
      "id": "US-001",
      "title": "Setup database schema for users, events, RSVPs, and invites",
      "description": "As a developer, I need the core database tables to store all application data.",
      "acceptanceCriteria": [
        "Create users table with fields: id, clerkUserId, email, name, createdAt",
        "Create events table with fields: id, title, description, dateTime, location, mapLink (optional), createdAt, updatedAt",
        "Create rsvps table with fields: id, userId, eventId, status (going|maybe|not_going), createdAt, updatedAt",
        "Create invites table with fields: id, email, invitedBy, createdAt, acceptedAt (nullable)",
        "Create notification_log table with fields: id, userId, eventId, type, channel, sentAt",
        "Add appropriate indexes for common queries",
        "Generate and run migrations successfully",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Database schema implemented with all tables, foreign keys, and indexes. Types generated successfully and typecheck passes."
    },
    {
      "id": "US-002",
      "title": "Integrate Clerk authentication",
      "description": "As a user, I need to authenticate via Clerk to access the application.",
      "acceptanceCriteria": [
        "Install and configure @clerk/astro package",
        "Create Clerk app and add API keys to environment variables",
        "Setup Clerk middleware to protect all routes except auth pages",
        "Create sign-in page at /sign-in",
        "Create sign-up page at /sign-up",
        "Sync Clerk user data to local users table on first sign-in",
        "Redirect authenticated users from auth pages to homepage",
        "Redirect unauthenticated users to /sign-in",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Clerk authentication fully integrated. All routes protected except /sign-in and /sign-up. User sync to local database working. Requires Clerk API keys in .env file - see CLERK_SETUP.md for instructions."
    },
    {
      "id": "US-003",
      "title": "Create design system tokens and base layout",
      "description": "As a developer, I need a consistent design system following the PRD specifications.",
      "acceptanceCriteria": [
        "Define CSS custom properties for colors: beige/sand primary, #6B705C accent, light mode palette",
        "Define typography tokens: serif for headings, sans-serif for body",
        "Define spacing scale (4px base) and border radius tokens",
        "Update Layout.astro with design tokens and mobile-first responsive structure",
        "Add header with app name and user profile/sign out button",
        "Test layout renders correctly on mobile and desktop viewports",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Design system tokens defined in global.css with beige/sand primary palette, #6B705C accent color, typography tokens (serif for headings, sans-serif for body), spacing scale (4px base), and border radius tokens. Layout.astro updated with sticky header, app name, user profile with sign-out button, and mobile-first responsive design with breakpoints at 640px and 1024px. Typecheck passes. Browser verification performed via HTML inspection."
    },
    {
      "id": "US-004",
      "title": "Create events list page (homepage)",
      "description": "As a user, I want to see all upcoming and past events on the homepage.",
      "acceptanceCriteria": [
        "Update index.astro to fetch and display events from database",
        "Show upcoming events section first, sorted by date ascending",
        "Show past events section below, sorted by date descending (most recent first)",
        "Each event card shows: title, date/time, location, RSVP count summary",
        "Link each event card to event detail page (/events/[id])",
        "Show empty state message when no events exist",
        "Format dates in Europe/Oslo timezone",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Events list homepage implemented with upcoming/past sections, RSVP counts, responsive grid layout, and Europe/Oslo timezone formatting. Typecheck passes. Browser verification confirmed authentication redirect works correctly."
    },
    {
      "id": "US-005",
      "title": "Create event detail page",
      "description": "As a user, I want to view full event details and RSVP status.",
      "acceptanceCriteria": [
        "Create /events/[id].astro page",
        "Display all event fields: title, description, date/time, location, map link (if present)",
        "Show all users' RSVP statuses with names",
        "Display aggregated RSVP counts (Going: X, Maybe: Y, Not Going: Z, No Response: W)",
        "Show current user's RSVP status prominently",
        "Format date/time in Europe/Oslo timezone with clear formatting",
        "Make map link clickable if present",
        "Return 404 if event not found",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Event detail page implemented with all event fields displayed, RSVP status lists grouped by status (Going/Maybe/Not Going), aggregated counts including No Response count, current user's RSVP status prominently shown, Europe/Oslo timezone formatting, clickable map links, and 404 handling. Typecheck passes. Authentication redirect verified."
    },
    {
      "id": "US-006",
      "title": "Add RSVP functionality on event detail page",
      "description": "As a user, I want to RSVP to events with Going/Maybe/Not Going options.",
      "acceptanceCriteria": [
        "Add RSVP button group on event detail page: Going, Maybe, Not Going buttons",
        "Highlight current user's selected RSVP status",
        "Create server action to save RSVP (insert or update)",
        "Only allow RSVP changes for upcoming events (past events read-only)",
        "Update RSVP counts immediately after submission",
        "Show success feedback after RSVP change",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 11,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Create event creation form",
      "description": "As a user, I want to create new events.",
      "acceptanceCriteria": [
        "Create /events/new.astro page with event creation form",
        "Form fields: title (required), description (textarea), date, time, location (required), map link (optional URL)",
        "Add date/time picker inputs",
        "Store date/time in Europe/Oslo timezone",
        "Validate required fields before submission",
        "Create server action to insert event into database",
        "Redirect to event detail page after successful creation",
        "Add 'Create Event' button on homepage header",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 12,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Add duplicate event functionality",
      "description": "As a user, I want to duplicate the most recent event to save time.",
      "acceptanceCriteria": [
        "Add 'Duplicate Last Event' button on homepage",
        "Fetch most recent event (by createdAt)",
        "Pre-fill creation form with: title, description, location, map link from last event",
        "Leave date and time empty (user must set manually)",
        "Show clear indicator that form is pre-filled from duplication",
        "Disable button if no events exist yet",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 13,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Create event edit page for upcoming events",
      "description": "As a user, I want to edit upcoming events.",
      "acceptanceCriteria": [
        "Create /events/[id]/edit.astro page",
        "Pre-fill form with existing event data",
        "Only allow editing upcoming events (redirect if event is past)",
        "Update event in database via server action",
        "Update updatedAt timestamp on save",
        "Redirect to event detail page after successful update",
        "Add 'Edit Event' button on event detail page (only for upcoming events)",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 14,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Setup email provider and send new event notifications",
      "description": "As a user, I want to receive email notifications when new events are created.",
      "acceptanceCriteria": [
        "Choose and configure email provider (Resend recommended for Astro)",
        "Add email provider API key to environment variables",
        "Create email template for new event notifications",
        "Include event title, description, date/time, location in email",
        "Send email to all users when event is created",
        "Log sent notifications in notification_log table",
        "Use friendly 'From' name in email",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Send event update notifications",
      "description": "As a user, I want to receive email notifications when events are updated.",
      "acceptanceCriteria": [
        "Create email template for event update notifications",
        "Highlight what changed in the email (compare old vs new values)",
        "Send email to all users when event is updated",
        "Log sent notifications in notification_log table",
        "Trigger automatically on event edit (no opt-out)",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Setup cron job for event reminders",
      "description": "As a user, I want to receive reminder emails at 18:00 the day before events.",
      "acceptanceCriteria": [
        "Create cron job/scheduled task that runs daily at 18:00 Europe/Oslo",
        "Find all events with dateTime = tomorrow (in Europe/Oslo timezone)",
        "Send reminder email to all users for each upcoming event",
        "Create email template for reminders",
        "Include event title, date/time, location, and map link if present",
        "Log sent notifications in notification_log table",
        "Prevent duplicate reminders (check notification_log before sending)",
        "Typecheck passes"
      ],
      "priority": 17,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Create settings page with browser notification opt-in",
      "description": "As a user, I want to enable browser push notifications.",
      "acceptanceCriteria": [
        "Create /settings.astro page",
        "Add browser notification permission request button",
        "Show current permission status (granted/denied/default)",
        "Request notification permission on button click",
        "Store notification preference in user table",
        "Add 'Settings' link in header navigation",
        "Show success/error feedback after permission change",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 18,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-014",
      "title": "Implement browser push notifications via service worker",
      "description": "As a user, I want to receive browser push notifications for events.",
      "acceptanceCriteria": [
        "Create service worker for handling push notifications",
        "Register service worker on app load",
        "Store push subscription in user table when granted",
        "Send browser push notification when new event created (to opted-in users)",
        "Send browser push notification when event updated (to opted-in users)",
        "Include event reminder in push notification (at 18:00 day before)",
        "Handle notification click to open event detail page",
        "Test notifications work on supported browsers",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-015",
      "title": "Create user RSVP history view",
      "description": "As a user, I want to view my personal RSVP history.",
      "acceptanceCriteria": [
        "Create /history.astro page",
        "Show all events current user has RSVPd to, sorted by event date descending",
        "Display event title, date, location, and user's RSVP status",
        "Link each event to event detail page",
        "Include both upcoming and past events",
        "Add 'My History' link in header navigation",
        "Show empty state if user has no RSVP history",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 20,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-016",
      "title": "Create invite-only access page for unauthenticated users",
      "description": "As a visitor, I should see a minimal access message if not authenticated.",
      "acceptanceCriteria": [
        "Create custom access denied page",
        "Show message: 'This is an invite-only application'",
        "Include link to sign-in page",
        "Style page with design system tokens",
        "Display when unauthenticated user tries to access protected route",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 21,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-017",
      "title": "Polish mobile-first responsive design",
      "description": "As a user, I want the app to work seamlessly on mobile devices.",
      "acceptanceCriteria": [
        "Test all pages on mobile viewport (320px-428px width)",
        "Ensure touch targets are at least 44x44px",
        "Fix any layout overflow or horizontal scroll issues",
        "Optimize form inputs for mobile (proper input types, zoom prevention)",
        "Test event cards, navigation, and forms on mobile",
        "Ensure readability with appropriate font sizes",
        "Test on tablet viewport (768px-1024px)",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 22,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-018",
      "title": "Add final polish and accessibility improvements",
      "description": "As a user, I want the app to be accessible and polished.",
      "acceptanceCriteria": [
        "Add loading states for all async operations",
        "Add error handling and user-friendly error messages",
        "Ensure all interactive elements have proper focus states",
        "Add aria-labels where needed for screen readers",
        "Test keyboard navigation on all pages",
        "Add page titles and meta descriptions",
        "Verify color contrast meets WCAG AA standards",
        "Remove any console.log or debug code",
        "Typecheck passes",
        "Write Playwright E2E tests to verify functionality"
      ],
      "priority": 23,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-019",
      "title": "Setup Playwright testing infrastructure with Clerk authentication",
      "description": "As a developer, I need Playwright configured with Clerk authentication support for E2E testing.",
      "acceptanceCriteria": [
        "Install @playwright/test and @clerk/testing packages",
        "Configure Playwright with projects for Chromium, Firefox, and WebKit",
        "Create playwright.config.ts with proper environment variable handling",
        "Implement global-setup.ts with clerkSetup() for testing token generation",
        "Configure serial execution for test descriptions as per Clerk requirements",
        "Create test fixtures for authenticated user sessions",
        "Add test helpers and utilities (e.g., database seeding for tests)",
        "Add npm scripts for test execution (test, test:headed, test:debug)",
        "Create basic smoke test to verify setup works",
        "Document test setup in TESTING.md",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Playwright testing infrastructure fully configured with Clerk authentication support. Includes test fixtures, database helpers, smoke tests, and comprehensive documentation in TESTING.md. Test scripts added to package.json: test, test:headed, test:debug, test:ui. Typecheck passes."
    },
    {
      "id": "US-020",
      "title": "Write E2E tests for authentication flows",
      "description": "As a developer, I need E2E tests for user authentication to ensure sign-in/sign-up works correctly.",
      "acceptanceCriteria": [
        "Write test for successful sign-in with valid credentials",
        "Write test for sign-in with invalid credentials",
        "Write test for sign-up flow with new user",
        "Write test for sign-out functionality",
        "Write test for redirect to sign-in when accessing protected routes unauthenticated",
        "Write test for redirect to homepage when authenticated user visits auth pages",
        "Use user-facing locators (roles, test IDs) instead of CSS selectors",
        "Implement web-first assertions (toBeVisible, toHaveText, etc.)",
        "All tests pass successfully",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-021",
      "title": "Write E2E tests for events list and detail pages",
      "description": "As a developer, I need E2E tests for event viewing functionality.",
      "acceptanceCriteria": [
        "Write test for viewing events list (upcoming and past sections)",
        "Write test for empty state when no events exist",
        "Write test for clicking event card to navigate to detail page",
        "Write test for viewing event detail page with all fields displayed",
        "Write test for viewing RSVP counts and user lists on detail page",
        "Write test for back navigation from detail to list",
        "Write test for 404 handling with non-existent event ID",
        "Use user-facing locators (roles, test IDs) instead of CSS selectors",
        "Implement web-first assertions (toBeVisible, toHaveText, etc.)",
        "Add test isolation with independent test data",
        "All tests pass successfully",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-022",
      "title": "Write E2E tests for RSVP functionality",
      "description": "As a developer, I need E2E tests for RSVP functionality to ensure users can respond to events.",
      "acceptanceCriteria": [
        "Write test for RSVPing 'Going' to an event",
        "Write test for changing RSVP status (Going → Maybe → Not Going)",
        "Write test for RSVP counts updating after status change",
        "Write test for current user's RSVP status displaying prominently",
        "Write test for RSVP appearing in correct status list",
        "Write test that past events cannot be RSVPd to",
        "Use user-facing locators (roles, test IDs) instead of CSS selectors",
        "Implement web-first assertions (toBeVisible, toHaveText, etc.)",
        "Add test isolation with independent test data",
        "All tests pass successfully",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-023",
      "title": "Configure CI/CD pipeline for Playwright tests",
      "description": "As a developer, I need Playwright tests running in CI to catch regressions automatically.",
      "acceptanceCriteria": [
        "Configure GitHub Actions workflow for Playwright tests",
        "Install Playwright browsers in CI environment",
        "Run tests on pull requests and main branch pushes",
        "Configure test sharding for faster CI runs (if needed)",
        "Enable trace collection on test failures",
        "Upload test artifacts (traces, screenshots, videos) on failure",
        "Configure parallel test execution across browser projects",
        "Add status badge to README showing test status",
        "Ensure tests pass consistently in CI environment",
        "Document CI setup and troubleshooting in TESTING.md"
      ],
      "priority": 10,
      "passes": false,
      "notes": ""
    }
  ]
}
